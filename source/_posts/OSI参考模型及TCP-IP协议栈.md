---
title: OSI参考模型及TCP/IP协议栈
abbrlink: 7e4a66b0
date: 2022-06-02 12:05:16
tags:
  - 锐捷
categories:
  - 学习
  - 锐捷
---


<div class="danger">

>  资料来源[锐捷](https://talent.ruijie.com.cn/certification/profession/)
>  非原创

</div>




## OSI参考模型

### OSI参考模型简介

* 为什么使用分层结构
  * 降低复杂性
  * 提高设备的兼容性
  * 提供标准化接口
  * 促进模块化工作
  * 简化教学和学习
  * 易于实现与维护
* OSI模型将数据通讯过程分割为7个层次，每个层次都负责各自的 功能，并设计了对应的协议实现这些功能，各个层次之间有标准化 的接口



### 协议数据单元（PDU）

![8](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114859.png)





### OSI参考模型各层次的功能

| OSI参考模型层次 |                      |                                                              |
| --------------- | -------------------- | ------------------------------------------------------------ |
| 应用层          | 提供应用程序间通讯   | 为网络用户之间的通信提供专用的程序 <br> 为用户提供网络管理、文件传输、事务处理等服务 <br>应用层包含的协议最多，也最复杂 |
| 表示层          | 数据表示、加密、解密 | 向上对应用层提供服务，向下接收会话层服务 <br>确保应用接收到的数据可读 <br>规范数据格式与结构 <br> 数据压缩和解压、加密和解密 |
| 会话层          | 会话建立维护         | 会话层不参与具体的传输，它提供包括访问验证和会话管理 <br>在不同的进程间建立管理维持会话，并能使会话获得同步 <br>担负应用进程服务要求，而运输层不能完成的那部分工作 |
| 传输层          | 建立主机端到端链接   | 处理主机之间的传输问题 <br> 确保数据传输的可靠性 <br>建立、维护和终止虚电路 <br>容错机制和流量控制 |
| 网络层          | 寻址和路由           | 路由数据包，提供逻辑寻址 <br>基于网络层地址进行不同网络系统间的最优路径选择 <br>网络层为建立网络连接和为上层提供服务 |
| 数据链路层      | 介质访问、链路管理   | 负责将上层数据封装成固定格式的帧 <br>为了防止数据传输过程中产生误码，在帧尾部加上校验信息 <br>还有流控机制 会试探接收方缓存调整速率大小 |
| 物理层          | 二进制传输           | 定义了电气、机械、形状针脚等物理特性。 <br> 主要功能是完成相邻节点之间原始比特流的传输，它关心的 是如何用物理信号表示0和1 |

### 报文封装与解封装



![9](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114904.png)

### 数据在不同网络设备之间转发

* 发送方对原始数据进行封装，通过介质发送到下一跳设备 

* 中间的网络设备对数据包进行解封装，查看对应信息，根据表项进行转发 

* 数据经过中转达到目的设备，解封装后到达目标应用程序



![10](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114906.png)



## TCP/IP协议栈

### 与OSI模型的区别 

*  TCP/IP总共定义了4层
*  OSI的1、2层合并为网络接入层 
*  OSI的5、6、7层合并为网络应用层 
*  OSI模型与TCP/IP模型都是描述网络设备之间通讯标准流程
*  TCP/IP模型是Internet的基本协



### TCP/IP协议桟与OSI参考模型对应关系

| TCP/IP     | OSI                        |
| ---------- | -------------------------- |
| 应用层     | 应用层<br>表示层<br>会话层 |
| 传输层     | 传输层                     |
| 网络层     | 网络层                     |
| 网络接入层 | 数据链路层 <br> 物理层     |

### TCP/IP协议栈各层功能

#### 应用层功能

为应用提供网络服务

*  网络应用
   * 微博、微信、QQ……
*  邮件服务（SMTP、POP3）
   * Outlook、新浪邮箱……
*  网页服务（http、https）
   * 百度、搜狐、网易
*  网络管理
   * SNMP
*  远程登陆
   * Telnet、ssh
*  地址服务
   * 	DNS、DHCP



#### 传输层功能

提供端到端传输服务

* 基于TCP的协议，可靠传输、有重传机制
  * FTP、SMTP、Telnet、HTTP
* 基于UDP的协议传输，不可靠、效率高
  * TFTP、SNMP、DHCP



TCP/UDP端口号范围是`0~65535`，其中`0~1023`是熟知端口号，已固定分配给常用应用程序



#### 网络层

* 提供主机到主机的传输服务

* IP

  * 提供主机到主机的传输服务

* ICMP

  * 辅助IP工作,提供出错和控制信息

* ARP

  * 解析IP与MAC的映射

#### 网络接入层

* 在相邻节点提供数据传输服务

* 局域网

  * IEEE802.2	定义LLC子层
  * IEEE802.3 	以太网标准

* 广域网

  * HDLC(高级数据链路控)协议)
  * PPP(点对点协议,类别:数据链路层协议)
  * Frame Relay(帧中继)

  

### 常见协议端口号

#### TCP端口号

| 协议     | 端口号 | 协议   | 端口号   | 协议     | 端口号 |
| -------- | ------ | ------ | -------- | -------- | ------ |
| FTP      | 21     | HTTP   | 80       | SMTP     | 25     |
| FT-daada | 20     | HTTPS  | 443      | POP3     | 110    |
| Telnet   | 23     | SQL    | １４３３ | Tacacs＋ | ４９   |
| SSH      | ２２   | Oracle | １５２１ | DNS      | ５３   |



#### UDP端口号


| 协议 | 端口号         | 协议   | 端口号     | 协议    | 端口号        |
| :--: | -------------- | ------ | ---------- | ------- | ------------- |
| DHCP | 67、68         | Radius | 1812、1813 | WINS    | 42            |
| TFTP | 69             | NTP    | 123        | NETBIOS | 137、138、139 |
| SNMP | １６１、１６２ | RIP    | ５２０     | DNS     | ５３          |





### 传输层的区别

* UDP报文结构简单，传输效率高，但不具备排序功能以及重传机制，数据包到达目的地时，有可能因为网 络问题，出现乱序或者丢包现象
  *  常用在视频、语音应用等



![1](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114916.png)

* TCP报文结构相对复杂，具备序列号、确认号、窗口大小等字段，使其具备排序功能、重传机制、滑动窗 口机制，确保数据传输的可靠性，使得数据能够准确按序到达目的地 

  * 常用在HTTP、FTP等可靠传输

    

![2](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114918.png)

### 传输层

* 基于TCP协议

  * 传输数据前:由TCP建立连接
  * 传输过程中:由TCP解决可靠性、有序性，进行流量控制
  * 传输结束后：由TCP拆除链接
* TCP头部字段

  * 端口号：源端口标识发送方的进程,目的端口表示接收方的进程
* 序列号:保证数据传输的有序性,确认收到的数据进行确认
  * 窗口大小:传输阶段每次连续发送数据的大小
* Flag字段:

  * ACK:确认标志号,置于1表示确认号有效,表示收到虽短的特定数据
    * RST:复位标志.至于1表示拒绝错误和非法的数据包,复位错误的链接
  * SYN:同步标志序号,至于1表示同步需要,用来建立连接
    * FIN:结束标志,至于1表示链接将被断开,用于拆除链接



![3](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114921.png)

### TCP协议工作过程

#### 建立连接

数据传输之前：三次握手建立连接



![4](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114923.png)



#### 数据传输

 数据传输过程中，发送方发送窗口大小的数据，接收方只进行一次确认

 如果接收方处理能力不足，会调整窗口大小，接收方按新的窗口进行数据发送

![5](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114925.png)



####  重传机制

 当某个包因网络问题，传输失败，接收方仅确认上一个数据包 

发送方将根据确认号，进行数据重传



![6](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114927.png)

####  拆除连接

四次挥手拆除连接， TCP通过FIN置位为1表示拆除连接



![7](https://luren-1310495826.cos.ap-beijing.myqcloud.com/blog/burp/20220602114929.png)
